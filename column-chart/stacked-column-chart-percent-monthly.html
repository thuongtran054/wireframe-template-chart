<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stacked 100% Bar Chart Monthly</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <style>
    body {
      font-family: 'Be Vietnam Pro', sans-serif;
      background: #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }
    #chart {
      width: 100%;
      height: 100vh;
    }
  </style>
</head>
<body>
  <div id="chart"></div>

  <script>
const colors = ['#145dfc', '#03c950', '#ed5a27', '#9b9b9b', '#f7b500'];

const categories = [
'Jan-25', 'Feb-25', 'Mar-25', 'Apr-25', 'May-25', 'Jun-25',
  'Jul-25', 'Aug-25', 'Sep-25', 'Oct-25', 'Nov-25', 'Dec-25','Jan-26','Feb-26'
];

// === Absolute data (≈ tổng 1200/ngày) ===
const dim1 = [480, 500, 390, 510, 195, 310, 500, 595, 510, 505,
              510, 520, 505, 500];
const dim2 = [220, 210, 230, 215, 225, 220, 230, 220, 215, 230,
              225, 220, 230, 225];
const dim3 = [250, 240, 245, 250, 240, 245, 250, 240, 245, 250,
              245, 250, 240, 245];
const dim4 = [230, 225, 235, 230, 225, 230, 235, 225, 230, 235,
              230, 225, 230, 235];
const dim5 = [220, 210, 215, 220, 215, 210, 215, 220, 215, 210,
              215, 220, 210, 215];

// === Convert to percentage for stacked-100 ===
function toPercentData(dataArrs) {
  const n = dataArrs[0].length;
  const totalArr = Array.from({ length: n }, (_, i) =>
    dataArrs.reduce((sum, arr) => sum + arr[i], 0)
  );
  return dataArrs.map(arr =>
    arr.map((v, i) => (v / totalArr[i] * 100).toFixed(1))
  );
}

const [dim1Pct, dim2Pct, dim3Pct, dim4Pct, dim5Pct] =
  toPercentData([dim1, dim2, dim3, dim4, dim5]);

// === Chart config ===
option = {
  textStyle: {
    fontFamily: 'Be Vietnam Pro, sans-serif',
    fontSize: 12,
    color: '#333'
  },
  xAxis: {
    type: 'category',
    data: categories
  },
  yAxis: {
    type: 'value',
    min: 0,
    max: 100,
    axisLabel: { formatter: '{value}%' },
    splitLine: { lineStyle: { type: 'dashed' } }
  },
  tooltip: {
 trigger: 'item',
  backgroundColor: 'rgba(255,255,255,0.95)',
  formatter: function (p) {
    const i = p.dataIndex;
    const date = categories[i];
    const total = dim1[i] + dim2[i] + dim3[i];
    const dimMap = {
      'Dim 1': { value: dim1[i], pct: dim1Pct[i] },
      'Dim 2': { value: dim2[i], pct: dim2Pct[i] },
      'Dim 3': { value: dim3[i], pct: dim3Pct[i] },
      'Dim 4': { value: dim4[i], pct: dim4Pct[i] },
      'Dim 5': { value: dim5[i], pct: dim5Pct[i] }
    };

    const marker = `<span style="display:inline-block;margin-right:5px;width:10px;height:10px;border-radius:50%;background:${p.color}"></span>`;
    const d = dimMap[p.seriesName];
    return `
      Report Month: ${date}<br/>
     ${p.seriesName}: ${d.value.toLocaleString('en-US')} (${d.pct}% of Total ${total.toLocaleString('en-US')} )<br/>
    `;
  }
},
  legend: {
    bottom: 5,
    icon: 'circle',
    data: ['Dim 1', 'Dim 2', 'Dim 3', 'Dim 4', 'Dim 5']
  },
  grid: {
    top: 10,
    left: 45,
    right: 20,
    bottom: 60
  },
  series: [
    { name: 'Dim 1', type: 'bar', stack: 'total', itemStyle: { color: colors[0] }, data: dim1Pct },
    { name: 'Dim 2', type: 'bar', stack: 'total', itemStyle: { color: colors[1] }, data: dim2Pct },
    { name: 'Dim 3', type: 'bar', stack: 'total', itemStyle: { color: colors[2] }, data: dim3Pct },
    { name: 'Dim 4', type: 'bar', stack: 'total', itemStyle: { color: colors[3] }, data: dim4Pct },
    { name: 'Dim 5', type: 'bar', stack: 'total', itemStyle: { color: colors[4] }, data: dim5Pct }
  ]
};
    const chartDom = document.getElementById('chart');
    const myChart = echarts.init(chartDom);
    myChart.setOption(option);

    window.addEventListener('resize', () => myChart.resize());
  </script>
</body>
</html>
